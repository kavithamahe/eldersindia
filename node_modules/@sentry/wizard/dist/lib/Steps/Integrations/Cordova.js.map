{"version":3,"file":"Cordova.js","sourceRoot":"","sources":["../../../../lib/Steps/Integrations/Cordova.ts"],"names":[],"mappings":"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","sourcesContent":["import * as fs from 'fs';\nimport { Answers, prompt } from 'inquirer';\nimport * as _ from 'lodash';\nimport * as path from 'path';\nimport { Args } from '../../Constants';\nimport { exists, matchesContent, patchMatchingFile } from '../../Helper/File';\nimport { dim, green, l, nl, red } from '../../Helper/Logging';\nimport { SentryCli } from '../../Helper/SentryCli';\nimport { BaseIntegration } from './BaseIntegration';\n\nconst xcode = require('xcode');\n\nexport class Cordova extends BaseIntegration {\n  protected sentryCli: SentryCli;\n  protected folderPrefix = 'platforms';\n  protected pluginFolder = ['.'];\n\n  constructor(protected argv: Args) {\n    super(argv);\n    this.sentryCli = new SentryCli(this.argv);\n  }\n\n  public async emit(answers: Answers): Promise<Answers> {\n    if (this.argv.uninstall) {\n      return this.uninstall(answers);\n    }\n\n    const sentryCliProperties = this.sentryCli.convertAnswersToProperties(\n      answers,\n    );\n\n    await patchMatchingFile(\n      `${this.folderPrefix}/ios/*.xcodeproj/project.pbxproj`,\n      this.patchXcodeProj.bind(this),\n    );\n\n    await this.addSentryProperties(sentryCliProperties);\n    green(`Successfully set up for cordova`);\n\n    return {};\n  }\n\n  public async uninstall(answers: Answers): Promise<Answers> {\n    await patchMatchingFile(\n      '**/*.xcodeproj/project.pbxproj',\n      this.unpatchXcodeProj.bind(this),\n    );\n\n    return {};\n  }\n\n  public async shouldConfigure(answers: Answers): Promise<Answers> {\n    if (this._shouldConfigure) {\n      return this._shouldConfigure;\n    }\n\n    let result = false;\n    if (!exists(path.join('sentry.properties'))) {\n      result = true;\n      this.debug(`sentry.properties not exists`);\n    }\n\n    if (\n      !matchesContent('**/*.xcodeproj/project.pbxproj', /SENTRY_PROPERTIES/gi)\n    ) {\n      result = true;\n      this.debug('**/*.xcodeproj/project.pbxproj not matched');\n    }\n\n    if (this.argv.uninstall) {\n      // if we uninstall we need to invert the result so we remove already patched\n      result = !result;\n    }\n\n    this._shouldConfigure = Promise.resolve({ cordova: result });\n    return this.shouldConfigure;\n  }\n\n  private unpatchXcodeProj(\n    contents: string,\n    filename: string,\n  ): Promise<string> {\n    const proj = xcode.project(filename);\n    return new Promise((resolve, reject) => {\n      proj.parse((err: any) => {\n        if (err) {\n          reject(err);\n          return;\n        }\n\n        this.unpatchXcodeBuildScripts(proj);\n        resolve(proj.writeSync());\n      });\n    });\n  }\n\n  private unpatchXcodeBuildScripts(proj: any): void {\n    const scripts = proj.hash.project.objects.PBXShellScriptBuildPhase || {};\n    const firstTarget = proj.getFirstTarget().uuid;\n    const nativeTargets = proj.hash.project.objects.PBXNativeTarget;\n\n    // scripts to kill entirely.\n    for (const key of Object.keys(scripts)) {\n      const script = scripts[key];\n\n      // ignore comments and keys that got deleted\n      if (typeof script === 'string' || script === undefined) {\n        continue;\n      }\n\n      if (\n        script.shellScript.match(/SENTRY_PROPERTIES/) ||\n        script.shellScript.match(/SENTRY_FRAMEWORK_PATCH/)\n      ) {\n        delete scripts[key];\n        delete scripts[key + '_comment'];\n        const phases = nativeTargets[firstTarget].buildPhases;\n        if (phases) {\n          for (let i = 0; i < phases.length; i++) {\n            if (phases[i].value === key) {\n              phases.splice(i, 1);\n              break;\n            }\n          }\n        }\n        continue;\n      }\n    }\n  }\n\n  private patchXcodeProj(\n    contents: string,\n    filename: string,\n  ): Promise<void | string> {\n    const proj = xcode.project(filename);\n    return new Promise((resolve, reject) => {\n      proj.parse((err: any) => {\n        if (err) {\n          reject(err);\n          return;\n        }\n\n        const buildScripts = [];\n        for (const key in proj.hash.project.objects.PBXShellScriptBuildPhase ||\n          {}) {\n          if (\n            proj.hash.project.objects.PBXShellScriptBuildPhase.hasOwnProperty(\n              key,\n            )\n          ) {\n            const val = proj.hash.project.objects.PBXShellScriptBuildPhase[key];\n            if (val.isa) {\n              buildScripts.push(val);\n            }\n          }\n        }\n\n        this.addNewXcodeBuildPhaseForSymbols(buildScripts, proj);\n        this.addNewXcodeBuildPhaseForStripping(buildScripts, proj);\n\n        // we always modify the xcode file in memory but we only want to save it\n        // in case the user wants configuration for ios.  This is why we check\n        // here first if changes are made before we might prompt the platform\n        // continue prompt.\n        const newContents = proj.writeSync();\n        if (newContents === contents) {\n          resolve();\n        } else {\n          resolve(newContents);\n        }\n      });\n    });\n  }\n\n  private addNewXcodeBuildPhaseForSymbols(buildScripts: any, proj: any): void {\n    for (const script of buildScripts) {\n      if (script.shellScript.match(/SENTRY_PROPERTIES/)) {\n        return;\n      }\n    }\n    const cwd = path.join(process.cwd(), 'sentry.properties');\n    proj.addBuildPhase(\n      [],\n      'PBXShellScriptBuildPhase',\n      'Upload Debug Symbols to Sentry',\n      null,\n      {\n        shellPath: '/bin/sh',\n        shellScript:\n          'export SENTRY_PROPERTIES=' +\n          cwd +\n          '\\\\n' +\n          'function getProperty {\\\\n' +\n          '    PROP_KEY=$1\\\\n' +\n          '    PROP_VALUE=`cat $SENTRY_PROPERTIES | grep \"$PROP_KEY\" | cut -d\\'=\\' -f2`\\\\n' +\n          '    echo $PROP_VALUE\\\\n' +\n          '}\\\\n' +\n          'if [ ! -f $SENTRY_PROPERTIES ]; then\\\\n' +\n          '  echo \"warning: SENTRY: sentry.properties file not found! Skipping symbol upload.\"\\\\n' +\n          '  exit 0\\\\n' +\n          'fi\\\\n' +\n          'echo \"# Reading property from $SENTRY_PROPERTIES\"\\\\n' +\n          'SENTRY_CLI=$(getProperty \"cli.executable\")\\\\n' +\n          'SENTRY_COMMAND=\"../../$SENTRY_CLI upload-dsym\"\\\\n' +\n          '$SENTRY_COMMAND',\n      },\n    );\n  }\n\n  private addNewXcodeBuildPhaseForStripping(\n    buildScripts: any,\n    proj: any,\n  ): void {\n    for (const script of buildScripts) {\n      if (script.shellScript.match(/SENTRY_FRAMEWORK_PATCH/)) {\n        return;\n      }\n    }\n    // tslint:disable:no-invalid-template-strings\n    // http://ikennd.ac/blog/2015/02/stripping-unwanted-architectures-from-dynamic-libraries-in-xcode/\n    proj.addBuildPhase(\n      [],\n      'PBXShellScriptBuildPhase',\n      'Sentry strip unused archs from Framework',\n      null,\n      {\n        shellPath: '/bin/sh',\n        shellScript:\n          '# SENTRY_FRAMEWORK_PATCH \\\\n' +\n          'APP_PATH=\"${TARGET_BUILD_DIR}/${WRAPPER_NAME}\"\\\\n' +\n          'find \"$APP_PATH\" -name \\'*.framework\\' -type d | while read -r FRAMEWORK\\\\n' +\n          'do\\\\n' +\n          'FRAMEWORK_EXECUTABLE_NAME=$(defaults read \"$FRAMEWORK/Info.plist\" CFBundleExecutable)\\\\n' +\n          'FRAMEWORK_EXECUTABLE_PATH=\"$FRAMEWORK/$FRAMEWORK_EXECUTABLE_NAME\"\\\\n' +\n          'echo \"Executable is $FRAMEWORK_EXECUTABLE_PATH\"\\\\n' +\n          'EXTRACTED_ARCHS=()\\\\n' +\n          'for ARCH in $ARCHS\\\\n' +\n          'do\\\\n' +\n          'echo \"Extracting $ARCH from $FRAMEWORK_EXECUTABLE_NAME\"\\\\n' +\n          'lipo -extract \"$ARCH\" \"$FRAMEWORK_EXECUTABLE_PATH\" -o \"$FRAMEWORK_EXECUTABLE_PATH-$ARCH\"\\\\n' +\n          'EXTRACTED_ARCHS+=(\"$FRAMEWORK_EXECUTABLE_PATH-$ARCH\")\\\\n' +\n          'done\\\\n' +\n          'echo \"Merging extracted architectures: ${ARCHS}\"\\\\n' +\n          'lipo -o \"$FRAMEWORK_EXECUTABLE_PATH-merged\" -create \"${EXTRACTED_ARCHS[@]}\"\\\\n' +\n          'rm \"${EXTRACTED_ARCHS[@]}\"\\\\n' +\n          'echo \"Replacing original executable with thinned version\"\\\\n' +\n          'rm \"$FRAMEWORK_EXECUTABLE_PATH\"\\\\n' +\n          'mv \"$FRAMEWORK_EXECUTABLE_PATH-merged\" \"$FRAMEWORK_EXECUTABLE_PATH\"\\\\n' +\n          'done',\n      },\n    );\n    // tslint:enable:no-invalid-template-strings\n  }\n\n  private addSentryProperties(properties: any): Promise<void> {\n    let rv = Promise.resolve();\n    const fn = path.join('sentry.properties');\n    if (exists(fn)) {\n      return rv;\n    }\n    rv = rv.then(() =>\n      fs.writeFileSync(fn, this.sentryCli.dumpProperties(properties)),\n    );\n\n    return rv;\n  }\n}\n"]}